<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Low Vision Experience - Digital Accessibility Empathy Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .transition-all { transition: all 0.3s ease; }

        /* --- INACCESSIBLE MODE STYLES --- */
        .inaccessible-mode .low-contrast-label { color: #e5e7eb !important; }
        .inaccessible-mode .low-contrast-border { border-color: #f3f4f6 !important; }
        .inaccessible-mode input::placeholder { color: #eeeeee !important; opacity: 1; }
        .inaccessible-mode *:focus { outline: none !important; box-shadow: none !important; }
        .inaccessible-mode .proximity-box { display: flex; justify-content: space-between; width: 100%; }
        .inaccessible-mode .zoom-container { height: 1.1rem; overflow: hidden; margin-bottom: 0.25rem; }
        .inaccessible-mode .no-scale { display: inline-block; transform: scale(var(--reverse-zoom, 1)); transform-origin: left; }

        /* THE "IMMOBILE" BUTTON WRAPPER */
        .inaccessible-mode .btn-wrapper {
            position: relative !important;
            width: 156px !important; 
            height: 44px !important;
            min-width: 156px !important;
            max-width: 156px !important;
            overflow: hidden !important;
            background-color: #2563eb !important;
            border-radius: 8px !important;
            display: block !important;
            border: none !important;
        }
        
        .inaccessible-mode .btn-fixed {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            color: white !important;
            height: 44px !important;
            width: max-content !important; 
            padding: 0 12px !important;
            display: flex !important;
            align-items: center !important;
            white-space: nowrap !important;
            font-weight: 700 !important;
            text-transform: uppercase !important;
            /* CHANGED PARAMETER ONLY */
            font-size: 0.875em !important;
            background: transparent !important;
            border: none !important;
        }

        .inaccessible-mode .btn-wrapper:hover { background-color: #93c5fd !important; }

        /* Tooltip behavior */
        .tooltip-box {
            display: none; position: absolute; background: #1f2937; color: white;
            padding: 12px; width: 220px; z-index: 50; left: 20px; top: 10px; border-radius: 8px;
        }
        .inaccessible-mode .info-trigger:hover + .tooltip-box { display: block; }
        .inaccessible-mode .tooltip-box:hover { display: none !important; }

        /* --- ACCESSIBLE MODE STYLES --- */
        .accessible-mode *:focus-visible { outline: 3px solid #2563eb !important; outline-offset: 2px !important; }
        
        .accessible-mode .btn-wrapper { 
            width: 100% !important; 
            max-width: none !important;
            height: auto !important;
        }
        
        .accessible-mode .btn-fixed {
            position: relative !important;
            background-color: #2563eb !important;
            color: white !important;
            min-height: 44px !important;
            padding: 12px 24px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            width: 100% !important;
            border-radius: 8px !important;
            font-weight: 700 !important;
            text-transform: uppercase !important;
            font-size: 0.875rem !important;
        }
        
        .accessible-mode .btn-fixed:hover { background-color: #172554 !important; color: #ffffff !important; }
        .accessible-mode .info-trigger:hover + .tooltip-box,
        .accessible-mode .info-trigger:focus + .tooltip-box,
        .accessible-mode .tooltip-box:hover,
        .accessible-mode .tooltip-box.kb-visible { display: block; }
        .accessible-mode .tooltip-box::before { content: ""; position: absolute; left: -40px; top: -10px; width: 40px; height: 150%; }

        /* Global UI components */
        .switch { position: relative; display: inline-block; width: 50px; height: 28px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ef4444; transition: .4s; border-radius: 28px; }
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #15803d; }
        input:checked + .slider:before { transform: translateX(22px); }
        .tab-btn[aria-selected="true"] { background-color: #111827; color: #60a5fa; border-bottom: 2px solid #60a5fa; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 md:p-8 font-sans transition-colors duration-500 inaccessible-mode" id="bodyTag">

    <div class="max-w-6xl mx-auto bg-white shadow-2xl rounded-3xl overflow-hidden">
        <header class="bg-white border-b border-gray-100">
            <div class="p-6 flex flex-col md:flex-row justify-between items-center gap-6 border-b border-gray-50">
                <div id="txt-lab-title" class="text-xl md:text-2xl font-black tracking-tight uppercase" style="color: #008B63;">Digital Accessibility Empathy Lab</div>
                <img src="https://regine-lambrecht.github.io/color-contrast-checker-size-weight/images/banner.png" alt="Logo" class="h-12">
            </div>

            <nav class="p-4 flex flex-col gap-4">
                <div class="flex items-center justify-between gap-4 bg-gray-50 p-3 rounded-2xl border border-gray-200">
                    <div class="flex items-center gap-4">
                        <span class="text-xs font-black uppercase tracking-widest text-red-600">Inaccessible</span>
                        <label class="switch">
                            <input type="checkbox" id="modeToggle" onchange="toggleMode()" role="switch">
                            <span class="slider"></span>
                        </label>
                        <span class="text-xs font-black uppercase tracking-widest text-green-700">Accessible</span>
                    </div>
                    <div class="flex gap-2 text-[10px] font-bold">
                        <button onclick="setLanguage('en')" class="lang-btn px-2 py-1 rounded" id="btn-en">EN</button>
                        <button onclick="setLanguage('fr')" class="lang-btn px-2 py-1 rounded" id="btn-fr">FR</button>
                        <button onclick="setLanguage('nl')" class="lang-btn px-2 py-1 rounded" id="btn-nl">NL</button>
                        <button onclick="setLanguage('de')" class="lang-btn px-2 py-1 rounded" id="btn-de">DE</button>
                    </div>
                </div>
                <h1 id="txt-title" class="text-xl font-black text-gray-900 px-2 uppercase tracking-tighter">Low Vision Experience</h1>
            </nav>
        </header>

        <main class="p-6 md:p-10">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-16">
                <div class="lg:col-span-1 space-y-6">
                    <div>
                        <div class="zoom-container">
                            <label id="txt-label-name" class="text-xs font-semibold uppercase tracking-wider low-contrast-label">Full Name</label>
                        </div>
                        <input type="text" class="w-full border border-gray-300 p-2 rounded-lg bg-gray-50 text-sm low-contrast-border">
                    </div>

                    <div class="relative">
                        <div class="proximity-box mb-1">
                            <label id="txt-label-passport" class="text-xs font-semibold uppercase tracking-wider low-contrast-label">Passport ID</label>
                            <div class="relative inline-block">
                                <button type="button" id="info-btn" class="info-trigger cursor-help bg-blue-700 text-white rounded-full w-4 h-4 flex items-center justify-center text-[9px] font-bold">i</button>
                                <div class="tooltip-box shadow-xl text-xs" id="txt-tooltip">Tooltip text</div>
                            </div>
                        </div>
                        <input type="text" id="passport-input" class="w-full border border-gray-300 p-2 rounded-lg bg-gray-50 text-sm low-contrast-border">
                    </div>

                    <div>
                        <div class="no-scale mb-1">
                            <label id="txt-label-email" class="text-xs font-semibold uppercase tracking-wider low-contrast-label">Email Address</label>
                        </div>
                        <input type="email" class="w-full border border-gray-300 p-2 rounded-lg bg-gray-50 text-sm low-contrast-border">
                    </div>

                    <div class="btn-wrapper">
                        <button id="txt-btn" class="btn-fixed">Update Profile</button>
                    </div>
                </div>

                <div class="lg:col-span-3">
                    <div class="bg-gray-900 text-white rounded-2xl shadow-xl overflow-hidden h-full flex flex-col">
                        <div class="flex bg-gray-800 border-b border-gray-700">
                            <button id="tab-test" onclick="switchTab('test')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest" aria-selected="true">How to test</button>
                            <button id="tab-feedback" onclick="switchTab('feedback')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest border-l border-gray-700" aria-selected="false">Issues</button>
                            <button id="tab-user" onclick="switchTab('user')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest border-l border-gray-700" aria-selected="false">Impacted users</button>
                        </div>
                        <div id="panel-test" class="p-8 space-y-6 text-sm"><ol id="txt-test-steps" class="list-decimal pl-5 space-y-4 opacity-95"></ol></div>
                        <div id="panel-feedback" class="p-8 hidden text-sm"><h3 id="txt-feedback-title" class="text-blue-400 font-bold uppercase mb-6"></h3><div id="critiqueContent" class="space-y-6"></div></div>
                        <div id="panel-user" class="p-8 hidden text-sm"><div id="txt-user-content" class="opacity-95 leading-relaxed text-xs"></div></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const translations = {
            en: {
                labTitle: "Digital Accessibility Empathy Lab", title: "Low Vision Experience",
                name: "Full Name", passport: "Passport ID", email: "Email Address", btn: "Update Profile",
                tooltip: "Enter your 6-digit passport number without spaces.", passportHint: "(e.g. AB1234)",
                tabTest: "How to test", tabUser: "Impacted users", tabIssues: "Issues", tabRemediations: "Remediations",
                testSteps: [
                    "Zoom to 175% or 200%. The 'Full Name' label vanishes and the 'Update Profile' button truncates.",
                    "Look for the Passport placeholder. It is nearly invisible due to low contrast.",
                    "In bad mode, the 'i' icon is far right. Magnifier users will miss it.",
                    "Try to read the tooltip in bad mode; it disappears when you leave the icon.",
                    "In 'Accessible', focus the 'i' and press Space/Enter to toggle help."
                ],
                critiques: {
                    bad: { title: "What is wrong?", items: [
                        { f: "Fixed Box Clamping", c: "The button is physically locked to 156px. Zoomed text overflows and is hidden." },
                        { f: "Contrast Failure", c: "Placeholders have ~1.2:1 contrast, failing visibility requirements." },
                        { f: "Proximity Gap", c: "Magnifier users see the label but never see the help icon at the screen edge." }
                    ]},
                    good: { title: "How to remediate", items: [
                        { f: "Fluid Containers", c: "Allow elements to grow naturally with enlarged text." },
                        { f: "Contrast Compliance", c: "Maintain at least 4.5:1 ratio for all text elements." },
                        { f: "Logical Proximity", c: "Group related labels and icons closely together." }
                    ]}
                },
                userTitle: "Who is impacted?",
                userList: ["**Low Vision users** who zoom.", "**Magnifier users**.", "**Aging users**."]
            },
            fr: {
                labTitle: "Labo d'Empathie Accessibilité", title: "Expérience Basse Vision",
                name: "Nom Complet", passport: "N° Passeport", email: "Adresse Email", btn: "Mettre à jour",
                tooltip: "Entrez les 6 chiffres sans espaces.", passportHint: "(ex: AB1234)",
                tabTest: "Comment tester", tabUser: "Impact", tabIssues: "Problèmes", tabRemediations: "Corrections",
                testSteps: ["Zoomez à 200%. Le bouton est tronqué.", "Le texte indicatif est presque invisible.", "L'icône est trop loin."],
                critiques: {
                    bad: { title: "Problèmes", items: [{ f: "Taille Fixe", c: "Le bouton ne s'agrandit pas au zoom." }] },
                    good: { title: "Corrections", items: [{ f: "Fluide", c: "Le bouton s'adapte au texte." }] }
                },
                userTitle: "Qui est impacté ?", userList: ["**Malvoyants**", "**Utilisateurs de loupe**"]
            },
            nl: {
                labTitle: "Toegankelijkheid Empathie Lab", title: "Lage Visus Ervaring",
                name: "Volledige Naam", passport: "Paspoort ID", email: "E-mailadres", btn: "Bijwerken",
                tooltip: "6 cijfers zonder spaties.", passportHint: "(bijv. AB1234)",
                tabTest: "Testen", tabUser: "Impact", tabIssues: "Problemen", tabRemediations: "Oplossingen",
                testSteps: ["Zoom naar 200%. De knop wordt afgesneden.", "Groot contrastverschil.", "Icoon staat te ver."],
                critiques: {
                    bad: { title: "Problemen", items: [{ f: "Vaste breedte", c: "Knop groeit niet mee." }] },
                    good: { title: "Oplossingen", items: [{ f: "Flexibel", c: "Groeit mee met zoom." }] }
                },
                userTitle: "Wie ondervindt hinder?", userList: ["**Slechtzienden**", "**Schermloep-gebruikers**"]
            },
            de: {
                labTitle: "Barrierefreiheit Empathie-Labor", title: "Sehbehinderung Erfahrung",
                name: "Name", passport: "Reisepass-ID", email: "E-Mail", btn: "Aktualisieren",
                tooltip: "6 Stellen ohne Leerzeichen.", passportHint: "(z.B. AB1234)",
                tabTest: "Testen", tabIssues: "Probleme", tabRemediations: "Lösungen",
                testSteps: ["Auf 200% zoomen. Button wird abgeschnitten.", "Schlechter Kontrast.", "Icon zu weit rechts."],
                critiques: {
                    bad: { title: "Probleme", items: [{ f: "Feste Größe", c: "Button skaliert nicht." }] },
                    good: { title: "Lösungen", items: [{ f: "Flüssig", c: "Skaliert mit." }] }
                },
                userTitle: "Wer ist betroffen?", userList: ["**Sehbehinderte**", "**Bildschirmlupen-Nutzer**"]
            }
        };

        let currentLang = 'en';

        function updateZoomVariable() {
            const isAcc = document.getElementById('modeToggle').checked;
            const zoom = window.devicePixelRatio || 1;
            document.documentElement.style.setProperty('--reverse-zoom', isAcc ? 1 : 1 / zoom);
        }

        function setLanguage(lang) {
            currentLang = lang;
            const t = translations[lang] || translations['en'];
            const isAcc = document.getElementById('modeToggle').checked;
            
            document.getElementById('txt-lab-title').innerText = t.labTitle;
            document.getElementById('txt-title').innerText = t.title;
            document.getElementById('txt-label-name').innerText = t.name;
            document.getElementById('txt-label-email').innerText = t.email;
            document.getElementById('txt-btn').innerText = t.btn;
            document.getElementById('txt-tooltip').innerText = t.tooltip;
            document.getElementById('txt-test-steps').innerHTML = t.testSteps.map(s => `<li>${s}</li>`).join('');
            
            const pInput = document.getElementById('passport-input');
            const pLabel = document.getElementById('txt-label-passport');
            if (isAcc) {
                pLabel.innerText = `${t.passport} ${t.passportHint}`;
                pInput.placeholder = "";
            } else {
                pLabel.innerText = t.passport;
                pInput.placeholder = "e.g. AB1234";
            }

            document.getElementById('txt-user-content').innerHTML = `
                <h3 class="text-blue-400 font-bold uppercase mb-4 text-xs">${t.userTitle}</h3>
                <ul class="list-disc pl-5 space-y-3">${(t.userList||[]).map(li => `<li>${li.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>')}</li>`).join('')}</ul>
            `;

            updateMode();
            document.querySelectorAll('.lang-btn').forEach(b => {
                b.classList.remove('bg-blue-600', 'text-white', 'bg-gray-200', 'text-gray-700');
                if (b.id === 'btn-' + lang) b.classList.add('bg-blue-600', 'text-white');
                else b.classList.add('bg-gray-200', 'text-gray-700');
            });
        }

        function toggleMode() {
            updateZoomVariable();
            setLanguage(currentLang);
        }

        function updateMode() {
            const isAcc = document.getElementById('modeToggle').checked;
            const t = translations[currentLang] || translations['en'];
            const crit = isAcc ? t.critiques.good : t.critiques.bad;
            
            document.getElementById('bodyTag').className = isAcc ? "bg-gray-100 min-h-screen p-4 md:p-8 font-sans accessible-mode" : "bg-gray-100 min-h-screen p-4 md:p-8 font-sans inaccessible-mode";
            
            document.getElementById('tab-feedback').innerText = isAcc ? t.tabRemediations : t.tabIssues;
            document.getElementById('txt-feedback-title').innerText = crit.title;
            document.getElementById('critiqueContent').innerHTML = (crit.items || []).map(i => `<div><span class="text-blue-400 font-bold block mb-1 uppercase text-[11px]">${i.f}</span><p class="text-white opacity-90">${i.c}</p></div>`).join('');
        }

        function switchTab(tabId) {
            ['test', 'feedback', 'user'].forEach(id => {
                const panel = document.getElementById('panel-' + id);
                const tab = document.getElementById('tab-' + id);
                if (panel) panel.classList.toggle('hidden', id !== tabId);
                if (tab) tab.setAttribute('aria-selected', id === tabId);
            });
        }

        const infoBtn = document.getElementById('info-btn');
        const tooltip = document.getElementById('txt-tooltip');
        infoBtn.addEventListener('keydown', (e) => {
            if (document.getElementById('modeToggle').checked && (e.key === ' ' || e.key === 'Enter')) {
                e.preventDefault();
                tooltip.classList.toggle('kb-visible');
            }
        });

        window.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                tooltip.classList.remove('kb-visible');
                tooltip.style.display = 'none';
                setTimeout(() => tooltip.style.display = '', 500);
            }
        });

        window.addEventListener('resize', updateZoomVariable);
        setLanguage('en');
        switchTab('test');
    </script>
</body>
</html>
