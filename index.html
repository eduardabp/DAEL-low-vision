<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Low Vision Experience - Digital Accessibility Empathy Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .transition-all { transition: all 0.3s ease; }

        /* --- THE BAD WAY STYLES --- */
        
        .inaccessible-mode .low-contrast-label { color: #d1d5db !important; }

        .inaccessible-mode .zoom-container {
            height: 1.2rem; 
            overflow: hidden;
            margin-bottom: 0.25rem;
        }

        .inaccessible-mode .no-scale {
            display: inline-block;
            transform: scale(var(--reverse-zoom, 1));
            transform-origin: left;
        }

        .inaccessible-mode .proximity-box {
            display: flex;
            justify-content: space-between;
            width: 100%;
        }

        /* Tooltip Logic */
        .tooltip-box {
            display: none;
            position: absolute;
            background: #1f2937;
            color: white;
            padding: 12px;
            width: 200px;
            z-index: 50;
            left: 20px;
            top: 10px;
            border-radius: 8px;
        }

        /* Bridge for Accessible Mode */
        .accessible-mode .info-trigger:hover + .tooltip-box,
        .accessible-mode .tooltip-box:hover { display: block; }
        .accessible-mode .tooltip-box::before {
            content: "";
            position: absolute;
            left: -40px; top: -10px; width: 40px; height: 150%;
        }
        
        .inaccessible-mode .info-trigger:hover + .tooltip-box { display: block; }
        .inaccessible-mode .tooltip-box:hover { display: none !important; }

        /* --- BUTTON TRUNCATION (FIXED) --- */
        /* We use a wrapper with a hard width and hidden overflow */
        .inaccessible-mode .btn-wrapper {
            width: 100px !important; 
            overflow: hidden !important;
            border-radius: 8px;
        }
        
        .inaccessible-mode .btn-fixed {
            background-color: #2563eb;
            color: white;
            height: 44px;
            padding: 0 12px;
            font-weight: bold;
            display: block;
            width: max-content; /* This ensures the inner text stays on one line and keeps growing */
            text-align: left;
            white-space: nowrap;
        }

        /* Accessible version: Fluid and wrapping */
        .accessible-mode .btn-wrapper { width: 100%; }
        .accessible-mode .btn-fixed {
            background-color: #2563eb;
            color: white;
            min-height: 44px;
            padding: 10px 20px;
            font-weight: bold;
            display: block;
            width: 100%;
            border-radius: 8px;
        }

        /* --- UI HELPERS --- */
        .switch { position: relative; display: inline-block; width: 50px; height: 28px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
            background-color: #ef4444; transition: .4s; border-radius: 28px;
        }
        .slider:before {
            position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px;
            background-color: white; transition: .4s; border-radius: 50%;
        }
        input:checked + .slider { background-color: #15803d; }
        input:checked + .slider:before { transform: translateX(22px); }

        .tab-btn[aria-selected="true"] {
            background-color: #111827;
            color: #60a5fa;
            border-bottom: 2px solid #60a5fa;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 md:p-8 font-sans transition-colors duration-500 inaccessible-mode" id="bodyTag">

    <div class="max-w-6xl mx-auto bg-white shadow-2xl rounded-3xl overflow-hidden">
        
        <header class="bg-white border-b border-gray-100">
            <div class="p-6 flex flex-col md:flex-row justify-between items-center gap-6 border-b border-gray-50">
                <div id="txt-lab-title" class="text-xl md:text-2xl font-black tracking-tight leading-tight uppercase" style="color: #008B63;">Digital Accessibility Empathy Lab</div>
                <img src="https://regine-lambrecht.github.io/color-contrast-checker-size-weight/images/banner.png" alt="Logo" class="h-12">
            </div>

            <nav class="p-4 flex flex-col gap-4">
                <div class="flex flex-wrap items-center justify-between gap-4 bg-gray-50 p-3 rounded-2xl border border-gray-200 w-full">
                    <div class="flex items-center gap-4">
                        <span class="text-xs font-black uppercase tracking-widest text-red-600">Inaccessible</span>
                        <label class="switch">
                            <input type="checkbox" id="modeToggle" onchange="toggleMode()" role="switch">
                            <span class="slider"></span>
                        </label>
                        <span class="text-xs font-black uppercase tracking-widest text-green-700">Accessible</span>
                    </div>

                    <div class="flex gap-2 text-[10px] font-bold">
                        <button onclick="setLanguage('en')" class="lang-btn px-2 py-1 rounded bg-blue-600 text-white" id="btn-en">EN</button>
                        <button onclick="setLanguage('fr')" class="lang-btn px-2 py-1 rounded bg-gray-200 text-gray-700" id="btn-fr">FR</button>
                        <button onclick="setLanguage('nl')" class="lang-btn px-2 py-1 rounded bg-gray-200 text-gray-700" id="btn-nl">NL</button>
                        <button onclick="setLanguage('de')" class="lang-btn px-2 py-1 rounded bg-gray-200 text-gray-700" id="btn-de">DE</button>
                    </div>
                </div>
                <h1 id="txt-title" class="text-xl font-black text-gray-900 px-2">Low Vision Experience</h1>
            </nav>
        </header>

        <main class="p-6 md:p-10">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-16">
                
                <div class="lg:col-span-1 space-y-6">
                    <div>
                        <div class="zoom-container">
                            <label id="txt-label-name" class="text-xs font-semibold uppercase tracking-wider low-contrast-label">Full Name</label>
                        </div>
                        <input type="text" class="w-full border border-gray-500 p-2 rounded-lg bg-gray-50 text-sm">
                    </div>

                    <div class="relative">
                        <div class="proximity-box mb-1">
                            <label id="txt-label-passport" class="text-xs font-semibold uppercase tracking-wider low-contrast-label">Passport ID</label>
                            <div class="relative inline-block">
                                <button type="button" class="info-trigger cursor-help bg-blue-700 text-white rounded-full w-4 h-4 flex items-center justify-center text-[9px] font-bold">i</button>
                                <div class="tooltip-box shadow-xl text-xs" id="txt-tooltip">Enter your 6-digit passport number without spaces.</div>
                            </div>
                        </div>
                        <input type="text" class="w-full border border-gray-500 p-2 rounded-lg bg-gray-50 text-sm">
                    </div>

                    <div>
                        <div class="no-scale mb-1">
                            <label id="txt-label-email" class="text-xs font-semibold uppercase tracking-wider low-contrast-label">Email Address</label>
                        </div>
                        <input type="email" class="w-full border border-gray-500 p-2 rounded-lg bg-gray-50 text-sm">
                    </div>

                    <div class="btn-wrapper">
                        <button id="txt-btn" class="btn-fixed text-sm">Update Profile</button>
                    </div>
                </div>

                <div class="lg:col-span-3">
                    <div class="bg-gray-900 text-white rounded-2xl shadow-xl overflow-hidden h-full flex flex-col">
                        <div class="flex bg-gray-800 border-b border-gray-700">
                            <button id="tab-test" onclick="switchTab('test')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest">How to test</button>
                            <button id="tab-feedback" onclick="switchTab('feedback')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest border-l border-gray-700">Issues</button>
                            <button id="tab-user" onclick="switchTab('user')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest border-l border-gray-700">Impacted users</button>
                        </div>

                        <div id="panel-test" class="p-8 space-y-6 text-sm">
                            <h3 id="txt-test-title" class="text-blue-400 font-black text-xs uppercase">Step-by-step guide</h3>
                            <ol id="txt-test-steps" class="list-decimal pl-5 space-y-4 opacity-95"></ol>
                        </div>

                        <div id="panel-feedback" class="p-8 hidden text-sm">
                            <h3 id="txt-feedback-title" class="text-blue-400 font-black text-xs uppercase mb-6">What is wrong?</h3>
                            <div id="critiqueContent" class="space-y-6"></div>
                        </div>

                        <div id="panel-user" class="p-8 hidden text-sm">
                            <h3 id="txt-user-title" class="text-blue-400 font-black text-xs uppercase mb-6">Who is impacted?</h3>
                            <div id="txt-user-content" class="opacity-95 leading-relaxed"></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const translations = {
            en: {
                labTitle: "Digital Accessibility Empathy Lab", title: "Low Vision Experience",
                name: "Full Name", passport: "Passport ID", email: "Email Address", btn: "Update Profile",
                tooltip: "Enter your 6-digit passport number without spaces.",
                tabTest: "How to test", tabUser: "Impacted users",
                testTitle: "Step-by-step guide",
                testSteps: [
                    "Zoom to 200%. The 'Full Name' label vanishes.",
                    "In Inaccessible mode, the help icon is far to the right. Magnifier users can't see it.",
                    "Try to move your mouse to the tooltip text. In bad mode, it vanishes.",
                    "The Email label refuses to grow during zoom.",
                    "Observe the button. At 200% zoom, the button container stays at 100px and the text truncates abruptly."
                ],
                userTitle: "Who is impacted?",
                userList: ["**Low Vision users** who zoom.", "**Magnifier users**.", "**Aging users**."],
                critiques: {
                    bad: { title: "What is wrong?", tab: "Issues", items: [
                        { f: "Fixed Height", c: "Container cuts off labels when zooming." },
                        { f: "Scale Counteracting", c: "The Email label explicitly blocks zoom via transform." },
                        { f: "Fixed Width Button", c: "The button is locked to 100px. As text grows, it overflows the container and is hidden." },
                        { f: "Hoverable Content", c: "Tooltip vanishes when you try to mouse over the actual text." }
                    ]},
                    good: { title: "How to remediate", tab: "Remediations", items: [
                        { f: "Fluid Containers", c: "Allow elements to grow vertically (WCAG 1.4.4)." },
                        { f: "Natural Scale", c: "Let the browser handle zoom naturally." },
                        { f: "Responsive Widths", c: "Allow buttons to grow or wrap text." },
                        { f: "Persistent Tooltips", c: "Ensure users can hover the tooltip content (WCAG 1.4.13)." }
                    ]}
                }
            },
            fr: {
                labTitle: "Labo d'Empathie Accessibilité", title: "Expérience Basse Vision",
                name: "Nom Complet", passport: "N° Passeport", email: "Adresse Email", btn: "Mettre à jour",
                tooltip: "Entrez les 6 chiffres.", tabTest: "Comment tester", tabUser: "Impact",
                testSteps: ["Zoomez à 200%.", "Le bouton est tronqué au zoom."],
                critiques: {
                    bad: { title: "Le problème ?", tab: "Problèmes", items: [{ f: "Tronqué", c: "Bouton à taille fixe." }] },
                    good: { title: "Correction", tab: "Corrections", items: [{ f: "Fluide", c: "S'adapte." }] }
                }
            }
        };

        let currentLang = 'en';

        function updateZoomVariable() {
            const isAcc = document.getElementById('modeToggle').checked;
            const zoom = window.devicePixelRatio || 1;
            document.documentElement.style.setProperty('--reverse-zoom', isAcc ? 1 : 1 / zoom);
        }

        function setLanguage(lang) {
            currentLang = lang;
            const t = translations[lang] || translations['en'];
            document.getElementById('txt-lab-title').innerText = t.labTitle;
            document.getElementById('txt-title').innerText = t.title;
            document.getElementById('txt-label-name').innerText = t.name;
            document.getElementById('txt-label-passport').innerText = t.passport;
            document.getElementById('txt-label-email').innerText = t.email;
            document.getElementById('txt-btn').innerText = t.btn;
            document.getElementById('txt-tooltip').innerText = t.tooltip;
            document.getElementById('tab-test').innerText = t.tabTest;
            document.getElementById('tab-user').innerText = t.tabUser;
            document.getElementById('txt-test-title').innerText = t.testTitle;
            document.getElementById('txt-test-steps').innerHTML = t.testSteps.map(s => `<li>${s}</li>`).join('');
            document.getElementById('txt-user-title').innerText = t.userTitle;
            document.getElementById('txt-user-content').innerHTML = `<ul class="list-disc pl-5 space-y-3">${(t.userList||[]).map(li => `<li>${li.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>')}</li>`).join('')}</ul>`;
            updateMode();
            document.querySelectorAll('.lang-btn').forEach(b => b.className = "lang-btn px-2 py-1 rounded bg-gray-200 text-gray-700");
            document.getElementById('btn-' + lang).className = "lang-btn px-2 py-1 rounded bg-blue-600 text-white";
        }

        function toggleMode() {
            updateZoomVariable();
            updateMode();
        }

        function updateMode() {
            const isAcc = document.getElementById('modeToggle').checked;
            const t = translations[currentLang] || translations['en'];
            const crit = isAcc ? t.critiques.good : t.critiques.bad;
            document.getElementById('bodyTag').className = isAcc ? "bg-gray-100 min-h-screen p-4 md:p-8 font-sans accessible-mode" : "bg-gray-100 min-h-screen p-4 md:p-8 font-sans inaccessible-mode";
            document.getElementById('tab-feedback').innerText = crit.tab;
            document.getElementById('txt-feedback-title').innerText = crit.title;
            document.getElementById('critiqueContent').innerHTML = (crit.items || []).map(i => `<div><span class="text-blue-400 font-bold block mb-1 uppercase text-[11px]">${i.f}</span><p class="text-white opacity-90">${i.c}</p></div>`).join('');
        }

        function switchTab(tabId) {
            ['test', 'feedback', 'user'].forEach(id => {
                document.getElementById('panel-' + id).classList.toggle('hidden', id !== tabId);
                document.getElementById('tab-' + id).setAttribute('aria-selected', id === tabId);
            });
        }

        window.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const tt = document.getElementById('txt-tooltip');
                tt.style.display = 'none';
                setTimeout(() => tt.style.display = '', 500);
            }
        });

        window.addEventListener('resize', updateZoomVariable);
        setLanguage('en');
        switchTab('test');
    </script>
</body>
</html>
