<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Low Vision Experience - Digital Accessibility Empathy Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .transition-all { transition: all 0.3s ease; }

        /* --- INACCESSIBLE MODE STYLES --- */
        .inaccessible-mode .low-contrast-label { color: #e5e7eb !important; }
        .inaccessible-mode .low-contrast-border { border-color: #f3f4f6 !important; }
        .inaccessible-mode input::placeholder { color: #eeeeee !important; opacity: 1; }
        .inaccessible-mode *:focus { outline: none !important; box-shadow: none !important; }
        
        /* Proximity Issue: Large gap between label and icon */
        .inaccessible-mode .proximity-box { display: flex; justify-content: space-between; width: 100%; align-items: center; }
        
        .inaccessible-mode .no-scale { display: inline-block; transform: scale(var(--reverse-zoom, 1)); transform-origin: left; }

        /* Tooltip behavior */
        .tooltip-box {
            display: none; position: absolute; background: #1f2937; color: white;
            padding: 12px; width: 220px; z-index: 50; left: 20px; top: 10px; border-radius: 8px;
        }
        .inaccessible-mode .info-trigger:hover + .tooltip-box { display: block; }
        .inaccessible-mode .tooltip-box:hover { display: none !important; }

        /* --- ACCESSIBLE MODE STYLES --- */
        .accessible-mode *:focus-visible { outline: 3px solid #2563eb !important; outline-offset: 2px !important; }
        
        /* Close Proximity for Magnifiers */
        .accessible-mode .proximity-box { display: flex; gap: 8px; align-items: center; width: 100%; }

        .accessible-mode .info-trigger:hover + .tooltip-box,
        .accessible-mode .info-trigger:focus + .tooltip-box,
        .accessible-mode .tooltip-box:hover,
        .accessible-mode .tooltip-box.kb-visible { display: block; }
        .accessible-mode .tooltip-box::before { content: ""; position: absolute; left: -40px; top: -10px; width: 40px; height: 150%; }

        /* --- LAYOUT SYNC --- */
        .label-row {
            height: 1.5rem !important;
            display: flex;
            align-items: center;
            margin-bottom: 0.25rem;
        }

        .info-panel-container {
            min-height: 350px !important; 
            display: flex;
            flex-direction: column;
        }

        /* Global UI components */
        .switch { position: relative; display: inline-block; width: 50px; height: 28px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ef4444; transition: .4s; border-radius: 28px; }
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #15803d; }
        input:checked + .slider:before { transform: translateX(22px); }
        .tab-btn[aria-selected="true"] { background-color: #111827; color: #60a5fa; border-bottom: 2px solid #60a5fa; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 md:p-8 font-sans transition-colors duration-500" id="bodyTag">

    <div class="max-w-6xl mx-auto bg-white shadow-2xl rounded-3xl overflow-hidden">
        <header class="bg-white border-b border-gray-100">
            <div class="p-6 flex flex-col md:flex-row justify-between items-center gap-6 border-b border-gray-50">
                <div id="txt-lab-title" class="text-xl md:text-2xl font-black tracking-tight uppercase" style="color: #008B63;">Digital Accessibility Empathy Lab</div>
                <img src="https://regine-lambrecht.github.io/color-contrast-checker-size-weight/images/banner.png" alt="Logo" class="h-12">
            </div>

            <nav class="p-4 flex flex-col gap-4">
                <div class="flex items-center justify-between gap-4 bg-gray-50 p-3 rounded-2xl border border-gray-200">
                    <div class="flex items-center gap-4">
                        <span class="text-xs font-black uppercase tracking-widest text-red-600">Inaccessible</span>
                        <label class="switch">
                            <input type="checkbox" id="modeToggle" onchange="toggleMode()" role="switch">
                            <span class="slider"></span>
                        </label>
                        <span class="text-xs font-black uppercase tracking-widest text-green-700">Accessible</span>
                    </div>
                    <div class="flex gap-2 text-[10px] font-bold">
                        <button onclick="setLanguage('en')" class="lang-btn px-2 py-1 rounded" id="btn-en">EN</button>
                        <button onclick="setLanguage('fr')" class="lang-btn px-2 py-1 rounded" id="btn-fr">FR</button>
                        <button onclick="setLanguage('nl')" class="lang-btn px-2 py-1 rounded" id="btn-nl">NL</button>
                        <button onclick="setLanguage('de')" class="lang-btn px-2 py-1 rounded" id="btn-de">DE</button>
                    </div>
                </div>
                <h1 id="txt-title" class="text-xl font-black text-gray-900 px-2 uppercase tracking-tighter">Low Vision Experience</h1>
            </nav>
        </header>

        <main class="p-6 md:p-10">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-16">
                <div class="lg:col-span-1 space-y-6">
                    <div>
                        <div class="label-row">
                            <label id="txt-label-name" class="text-xs font-semibold uppercase tracking-wider low-contrast-label">Full Name</label>
                        </div>
                        <input type="text" class="w-full border border-gray-300 p-2 rounded-lg bg-gray-50 text-sm low-contrast-border">
                    </div>

                    <div class="relative">
                        <div class="label-row proximity-box">
                            <label id="txt-label-passport" class="text-xs font-semibold uppercase tracking-wider low-contrast-label">Passport ID</label>
                            <div class="relative inline-block">
                                <button type="button" id="info-btn" class="info-trigger cursor-help bg-blue-700 text-white rounded-full w-4 h-4 flex items-center justify-center text-[9px] font-bold">i</button>
                                <div class="tooltip-box shadow-xl text-xs" id="txt-tooltip">Tooltip text</div>
                            </div>
                        </div>
                        <input type="text" id="passport-input" class="w-full border border-gray-300 p-2 rounded-lg bg-gray-50 text-sm low-contrast-border">
                    </div>

                    <div>
                        <div class="label-row">
                            <div class="no-scale">
                                <label id="txt-label-email" class="text-xs font-semibold uppercase tracking-wider low-contrast-label">Email Address</label>
                            </div>
                        </div>
                        <input type="email" class="w-full border border-gray-300 p-2 rounded-lg bg-gray-50 text-sm low-contrast-border">
                    </div>

                    <button id="txt-btn" class="w-full bg-blue-600 hover:bg-blue-800 text-white font-bold py-3 px-6 rounded-lg uppercase text-sm tracking-wide transition-colors">
                        Update Profile
                    </button>
                </div>

                <div class="lg:col-span-3">
                    <div class="info-panel-container bg-gray-900 text-white rounded-2xl shadow-xl overflow-hidden">
                        <div class="flex bg-gray-800 border-b border-gray-700">
                            <button id="tab-test" onclick="switchTab('test')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest" aria-selected="true">How to test</button>
                            <button id="tab-feedback" onclick="switchTab('feedback')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest border-l border-gray-700" aria-selected="false">Issues</button>
                            <button id="tab-user" onclick="switchTab('user')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest border-l border-gray-700" aria-selected="false">Impacted users</button>
                        </div>
                        <div id="panel-test" class="p-8 space-y-6 text-sm flex-grow"><ol id="txt-test-steps" class="list-decimal pl-5 space-y-4 opacity-95"></ol></div>
                        <div id="panel-feedback" class="p-8 hidden text-sm flex-grow"><h3 id="txt-feedback-title" class="text-blue-400 font-bold uppercase mb-6"></h3><div id="critiqueContent" class="space-y-6"></div></div>
                        <div id="panel-user" class="p-8 hidden text-sm flex-grow"><div id="txt-user-content" class="opacity-95 leading-relaxed text-xs"></div></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const translations = {
            en: {
                labTitle: "Digital Accessibility Empathy Lab", title: "Low Vision Experience",
                name: "Full Name", passport: "Passport ID", email: "Email Address", btn: "Update Profile",
                tooltip: "Enter your 6-digit passport number without spaces.", passportHint: "(e.g. AB1234)",
                tabTest: "How to test", tabUser: "Impacted users", tabIssues: "Issues", tabRemediations: "Remediations",
                testSteps: [
                    "Zoom to 200%. Compare how labels grow in both versions.",
                    "Look for the Passport placeholder. It is nearly invisible due to low contrast in 'Inaccessible'.",
                    "The 'i' icon is at the far right in 'Inaccessible' mode, causing issues for magnifier users.",
                    "In 'Inaccessible', the tooltip vanishes immediately when you move the mouse to read it.",
                    "In 'Accessible', focus the 'i' and press Space or Enter to toggle the help text."
                ],
                critiques: {
                    bad: { title: "What is wrong?", items: [
                        { f: "Contrast Failure", c: "Placeholder text contrast is too low (approx 1.2:1)." },
                        { f: "Proximity Gap", c: "Related icons placed far from labels are easily missed by magnifier users." },
                        { f: "Unreachable Tooltip", c: "Tooltip content is not persistent on hover and lacks keyboard focus support." }
                    ]},
                    good: { title: "Remediations", items: [
                        { f: "Contrast Compliance", c: "Maintain at least 4.5:1 contrast for all meaningful text and hints." },
                        { f: "Logical Proximity", c: "Group icons and labels closely to keep them in the same viewport." },
                        { f: "Accessible Tooltips", c: "Ensure tooltips stay open when hovered and are operable via keyboard." }
                    ]}
                },
                userTitle: "Who is impacted?",
                userList: ["**Low Vision users** who zoom.", "**Magnifier users**.", "**Aging users**."]
            },
            fr: {
                labTitle: "Labo d'Empathie Accessibilité", title: "Basse Vision",
                name: "Nom Complet", passport: "Passeport", email: "Email", btn: "Mettre à jour",
                tooltip: "6 chiffres sans espaces.", passportHint: "(ex: AB1234)",
                tabTest: "Test", tabUser: "Impact", tabIssues: "Problèmes", tabRemediations: "Corrections",
                testSteps: ["Zoomez à 200%.", "Texte indicatif presque invisible.", "Icône trop loin."],
                critiques: {
                    bad: { title: "Problèmes", items: [{ f: "Contraste", c: "Texte trop clair." }, { f: "Proximité", c: "Icône trop éloignée." }] },
                    good: { title: "Corrections", items: [{ f: "Visibilité", c: "Contraste 4.5:1." }, { f: "Regroupement", c: "Icône proche du texte." }] }
                },
                userTitle: "Impacté ?", userList: ["**Malvoyants**"]
            },
            nl: {
                labTitle: "Toegankelijkheid Lab", title: "Lage Visus",
                name: "Naam", passport: "Paspoort ID", email: "Email", btn: "Bijwerken",
                tooltip: "6 cijfers.", passportHint: "(bijv. AB1234)",
                tabTest: "Testen", tabUser: "Impact", tabIssues: "Problemen", tabRemediations: "Oplossingen",
                testSteps: ["Zoom naar 200%.", "Slecht contrast.", "Icoon te ver."],
                critiques: {
                    bad: { title: "Problemen", items: [{ f: "Contrast", c: "Te licht." }, { f: "Afstand", c: "Icoon staat te ver." }] },
                    good: { title: "Oplossingen", items: [{ f: "Duidelijkheid", c: "Min. 4.5:1 contrast." }] }
                },
                userTitle: "Wie?", userList: ["**Slechtzienden**"]
            },
            de: {
                labTitle: "Barrierefreiheit-Labor", title: "Sehbehinderung",
                name: "Name", passport: "Reisepass-ID", email: "E-Mail", btn: "Aktualisieren",
                tooltip: "6 Stellen.", passportHint: "(z.B. AB1234)",
                tabTest: "Testen", tabIssues: "Probleme", tabRemediations: "Lösungen",
                testSteps: ["Zoom 200%.", "Wenig Kontrast.", "Icon weit weg."],
                critiques: {
                    bad: { title: "Probleme", items: [{ f: "Kontrast", c: "Zu gering." }, { f: "Nähe", c: "Icon zu weit weg." }] },
                    good: { title: "Lösungen", items: [{ f: "Kontrast", c: "Min. 4.5:1." }] }
                },
                userTitle: "Wer?", userList: ["**Sehbehinderte**"]
            }
        };

        let currentLang = 'en';

        function updateZoomVariable() {
            const isAcc = document.getElementById('modeToggle').checked;
            const zoom = window.devicePixelRatio || 1;
            document.documentElement.style.setProperty('--reverse-zoom', isAcc ? 1 : 1 / zoom);
        }

        function setLanguage(lang) {
            currentLang = lang;
            const t = translations[lang] || translations['en'];
            const isAcc = document.getElementById('modeToggle').checked;
            
            document.getElementById('txt-lab-title').innerText = t.labTitle;
            document.getElementById('txt-title').innerText = t.title;
            document.getElementById('txt-label-name').innerText = t.name;
            document.getElementById('txt-label-email').innerText = t.email;
            document.getElementById('txt-btn').innerText = t.btn;
            document.getElementById('txt-tooltip').innerText = t.tooltip;
            document.getElementById('txt-test-steps').innerHTML = t.testSteps.map(s => `<li>${s}</li>`).join('');
            
            const pInput = document.getElementById('passport-input');
            const pLabel = document.getElementById('txt-label-passport');
            if (isAcc) {
                pLabel.innerText = `${t.passport} ${t.passportHint}`;
                pInput.placeholder = "";
            } else {
                pLabel.innerText = t.passport;
                pInput.placeholder = "e.g. AB1234";
            }

            document.getElementById('txt-user-content').innerHTML = `
                <h3 class="text-blue-400 font-bold uppercase mb-4 text-xs">${t.userTitle}</h3>
                <ul class="list-disc pl-5 space-y-3">${(t.userList||[]).map(li => `<li>${li.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>')}</li>`).join('')}</ul>
            `;

            updateMode();
            document.querySelectorAll('.lang-btn').forEach(b => {
                b.classList.remove('bg-blue-600', 'text-white', 'bg-gray-200', 'text-gray-700');
                if (b.id === 'btn-' + lang) b.classList.add('bg-blue-600', 'text-white');
                else b.classList.add('bg-gray-200', 'text-gray-700');
            });
        }

        function toggleMode() {
            updateZoomVariable();
            setLanguage(currentLang);
        }

        function updateMode() {
            const isAcc = document.getElementById('modeToggle').checked;
            const t = translations[currentLang] || translations['en'];
            const crit = isAcc ? t.critiques.good : t.critiques.bad;
            
            document.getElementById('bodyTag').className = isAcc ? "bg-gray-100 min-h-screen p-4 md:p-8 font-sans accessible-mode" : "bg-gray-100 min-h-screen p-4 md:p-8 font-sans inaccessible-mode";
            
            document.getElementById('tab-feedback').innerText = isAcc ? t.tabRemediations : t.tabIssues;
            document.getElementById('txt-feedback-title').innerText = crit.title;
            document.getElementById('critiqueContent').innerHTML = (crit.items || []).map(i => `<div><span class="text-blue-400 font-bold block mb-1 uppercase text-[11px]">${i.f}</span><p class="text-white opacity-90">${i.c}</p></div>`).join('');
        }

        function switchTab(tabId) {
            ['test', 'feedback', 'user'].forEach(id => {
                const panel = document.getElementById('panel-' + id);
                const tab = document.getElementById('tab-' + id);
                if (panel) panel.classList.toggle('hidden', id !== tabId);
                if (tab) tab.setAttribute('aria-selected', id === tabId);
            });
        }

        const infoBtn = document.getElementById('info-btn');
        const tooltip = document.getElementById('txt-tooltip');
        infoBtn.addEventListener('keydown', (e) => {
            if (document.getElementById('modeToggle').checked && (e.key === ' ' || e.key === 'Enter')) {
                e.preventDefault();
                tooltip.classList.toggle('kb-visible');
            }
        });

        window.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                tooltip.classList.remove('kb-visible');
                tooltip.style.display = 'none';
                setTimeout(() => tooltip.style.display = '', 500);
            }
        });

        window.addEventListener('resize', updateZoomVariable);
        setLanguage('en');
        switchTab('test');
    </script>
</body>
</html>
