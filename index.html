<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Low Vision Experience - Digital Accessibility Empathy Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .transition-all { transition: all 0.3s ease; }

        /* --- INACCESSIBLE MODE STYLES --- */
        .inaccessible-mode .low-contrast-label { color: #e5e7eb !important; }
        .inaccessible-mode .low-contrast-border { border-color: #f3f4f6 !important; }
        .inaccessible-mode input::placeholder { color: #eeeeee !important; opacity: 1; }
        .inaccessible-mode *:focus { outline: none !important; box-shadow: none !important; }
        
        /* Proximity Issue */
        .inaccessible-mode .proximity-box { display: flex; justify-content: space-between; width: 100%; }
        
        /* Label Height Cutoff */
        .inaccessible-mode .zoom-container { height: 1.1rem; overflow: hidden; margin-bottom: 0.25rem; }
        
        /* Blocked Scale */
        .inaccessible-mode .no-scale { display: inline-block; transform: scale(var(--reverse-zoom, 1)); transform-origin: left; }

        /* TRUNCATION: Fixed pixel width (145px) - Text disappears on zoom */
        .inaccessible-mode .btn-wrapper {
            width: 145px !important; 
            overflow: hidden !important;
            border-radius: 8px;
            background-color: #2563eb;
        }
        .inaccessible-mode .btn-fixed {
            color: white; height: 44px; padding: 0 10px;
            display: block; width: max-content; white-space: nowrap;
            text-align: left; font-weight: bold; text-transform: uppercase;
        }
        .inaccessible-mode .btn-fixed:hover { background-color: #93c5fd; color: #f3f4f6; }

        .tooltip-box {
            display: none; position: absolute; background: #1f2937; color: white;
            padding: 12px; width: 220px; z-index: 50; left: 20px; top: 10px; border-radius: 8px;
        }
        .inaccessible-mode .info-trigger:hover + .tooltip-box { display: block; }
        .inaccessible-mode .tooltip-box:hover { display: none !important; }

        /* --- ACCESSIBLE MODE STYLES --- */
        .accessible-mode *:focus-visible { outline: 3px solid #2563eb !important; outline-offset: 2px !important; }
        .accessible-mode .btn-wrapper { width: 100%; }
        .accessible-mode .btn-fixed {
            background-color: #2563eb; color: white; min-height: 48px;
            padding: 12px 24px; font-weight: bold; display: block; width: 100%; border-radius: 8px;
            text-transform: uppercase;
        }
        .accessible-mode .btn-fixed:hover { background-color: #172554; color: #ffffff; }
        
        .accessible-mode .info-trigger:hover + .tooltip-box,
        .accessible-mode .info-trigger:focus + .tooltip-box,
        .accessible-mode .tooltip-box:hover,
        .accessible-mode .tooltip-box.kb-visible { display: block; }
        .accessible-mode .tooltip-box::before {
            content: ""; position: absolute; left: -40px; top: -10px; width: 40px; height: 150%;
        }

        /* UI Structure */
        .switch { position: relative; display: inline-block; width: 50px; height: 28px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
            background-color: #ef4444; transition: .4s; border-radius: 28px;
        }
        .slider:before {
            position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px;
            background-color: white; transition: .4s; border-radius: 50%;
        }
        input:checked + .slider { background-color: #15803d; }
        input:checked + .slider:before { transform: translateX(22px); }
        .tab-btn[aria-selected="true"] { background-color: #111827; color: #60a5fa; border-bottom: 2px solid #60a5fa; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 md:p-8 font-sans transition-colors duration-500 inaccessible-mode" id="bodyTag">

    <div class="max-w-6xl mx-auto bg-white shadow-2xl rounded-3xl overflow-hidden">
        <header class="bg-white border-b border-gray-100">
            <div class="p-6 flex flex-col md:flex-row justify-between items-center gap-6 border-b border-gray-50">
                <div id="txt-lab-title" class="text-xl md:text-2xl font-black tracking-tight uppercase" style="color: #008B63;">Digital Accessibility Empathy Lab</div>
                <img src="https://regine-lambrecht.github.io/color-contrast-checker-size-weight/images/banner.png" alt="Logo" class="h-12">
            </div>

            <nav class="p-4 flex flex-col gap-4">
                <div class="flex flex-wrap items-center justify-between gap-4 bg-gray-50 p-3 rounded-2xl border border-gray-200 w-full">
                    <div class="flex items-center gap-4">
                        <span class="text-xs font-black uppercase tracking-widest text-red-600">Inaccessible</span>
                        <label class="switch">
                            <input type="checkbox" id="modeToggle" onchange="toggleMode()" role="switch" aria-label="Toggle accessibility version">
                            <span class="slider"></span>
                        </label>
                        <span class="text-xs font-black uppercase tracking-widest text-green-700">Accessible</span>
                    </div>
                    <div class="flex gap-2 text-[10px] font-bold">
                        <button onclick="setLanguage('en')" class="lang-btn px-2 py-1 rounded" id="btn-en">EN</button>
                        <button onclick="setLanguage('fr')" class="lang-btn px-2 py-1 rounded" id="btn-fr">FR</button>
                        <button onclick="setLanguage('nl')" class="lang-btn px-2 py-1 rounded" id="btn-nl">NL</button>
                        <button onclick="setLanguage('de')" class="lang-btn px-2 py-1 rounded" id="btn-de">DE</button>
                    </div>
                </div>
                <h1 id="txt-title" class="text-xl font-black text-gray-900 px-2 uppercase tracking-tighter">Low Vision Experience</h1>
            </nav>
        </header>

        <main class="p-6 md:p-10">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-16">
                <div class="lg:col-span-1 space-y-6">
                    <div>
                        <div class="zoom-container">
                            <label id="txt-label-name" class="text-xs font-semibold uppercase tracking-wider low-contrast-label">Full Name</label>
                        </div>
                        <input type="text" class="w-full border border-gray-500 p-2 rounded-lg bg-gray-50 text-sm low-contrast-border">
                    </div>

                    <div class="relative">
                        <div class="proximity-box mb-1">
                            <label id="txt-label-passport" class="text-xs font-semibold uppercase tracking-wider low-contrast-label">Passport ID</label>
                            <div class="relative inline-block">
                                <button type="button" id="info-btn" class="info-trigger cursor-help bg-blue-700 text-white rounded-full w-4 h-4 flex items-center justify-center text-[9px] font-bold">i</button>
                                <div class="tooltip-box shadow-xl text-xs" id="txt-tooltip">Tooltip text</div>
                            </div>
                        </div>
                        <input type="text" id="passport-input" class="w-full border border-gray-500 p-2 rounded-lg bg-gray-50 text-sm low-contrast-border">
                    </div>

                    <div>
                        <div class="no-scale mb-1">
                            <label id="txt-label-email" class="text-xs font-semibold uppercase tracking-wider low-contrast-label">Email Address</label>
                        </div>
                        <input type="email" class="w-full border border-gray-500 p-2 rounded-lg bg-gray-50 text-sm low-contrast-border">
                    </div>

                    <div class="btn-wrapper">
                        <button id="txt-btn" class="btn-fixed text-[11px]">Update Profile</button>
                    </div>
                </div>

                <div class="lg:col-span-3">
                    <div class="bg-gray-900 text-white rounded-2xl shadow-xl overflow-hidden h-full flex flex-col">
                        <div class="flex bg-gray-800 border-b border-gray-700">
                            <button id="tab-test" onclick="switchTab('test')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest" aria-selected="true">How to test</button>
                            <button id="tab-feedback" onclick="switchTab('feedback')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest border-l border-gray-700" aria-selected="false">Issues</button>
                            <button id="tab-user" onclick="switchTab('user')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest border-l border-gray-700" aria-selected="false">Impacted users</button>
                        </div>
                        
                        <div id="panel-test" class="p-8 space-y-6 text-sm">
                            <h3 id="txt-test-title" class="text-blue-400 font-bold uppercase">Step-by-step guide</h3>
                            <ol id="txt-test-steps" class="list-decimal pl-5 space-y-4 opacity-95"></ol>
                        </div>

                        <div id="panel-feedback" class="p-8 hidden text-sm">
                            <h3 id="txt-feedback-title" class="text-blue-400 font-bold uppercase mb-6"></h3>
                            <div id="critiqueContent" class="space-y-6"></div>
                        </div>

                        <div id="panel-user" class="p-8 hidden text-sm">
                            <div id="txt-user-content" class="opacity-95 leading-relaxed"></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const translations = {
            en: {
                labTitle: "Digital Accessibility Empathy Lab", title: "Low Vision Experience",
                name: "Full Name", passport: "Passport ID", email: "Email Address", btn: "Update Profile",
                tooltip: "Enter your 6-digit passport number without spaces.", passportHint: "(6 digits, no spaces)",
                tabTest: "How to test", tabUser: "Impacted users", tabIssues: "Issues", tabRemediations: "Remediations",
                testTitle: "Step-by-step guide",
                testSteps: [
                    "Zoom to 175% or 200%. The 'Full Name' label vanishes and the button truncates.",
                    "Look for the Passport placeholder. It is nearly invisible.",
                    "The 'i' icon is far to the right in bad mode. Magnifier users will miss it.",
                    "The tooltip vanishes in bad mode when you try to mouse over it.",
                    "In 'Accessible', use Space/Enter on 'i' to toggle help."
                ],
                userTitle: "Who is impacted?",
                userList: ["**Low Vision users** who zoom.", "**Magnifier users**.", "**Aging users**."],
                critiques: {
                    bad: { title: "What is wrong?", items: [
                        { f: "Contrast Failure", c: "Placeholder contrast is too low." },
                        { f: "Fixed Widths", c: "The button is locked at 145px; text is lost on zoom." },
                        { f: "Proximity", c: "Icon is too far from the label." }
                    ]},
                    good: { title: "How to remediate", items: [
                        { f: "4.5:1 Contrast", c: "Ensure all text is readable." },
                        { f: "Fluid Layout", c: "Components grow with text zoom." },
                        { f: "Grouped Elements", c: "Keep labels and icons close." }
                    ]}
                }
            },
            fr: {
                labTitle: "Labo d'Empathie Accessibilité", title: "Expérience Basse Vision",
                name: "Nom Complet", passport: "N° Passeport", email: "Adresse Email", btn: "Mettre à jour",
                tooltip: "Entrez les 6 chiffres sans espaces.", passportHint: "(6 chiffres, sans espaces)",
                tabTest: "Comment tester", tabUser: "Impact", tabIssues: "Problèmes", tabRemediations: "Corrections",
                testSteps: ["Zoomez à 200%.", "L'icône est trop loin.", "Le bouton est tronqué."],
                userTitle: "Qui est impacté ?", userList: ["Utilisateurs malvoyants", "Seniors"],
                critiques: {
                    bad: { title: "Problèmes", items: [{ f: "Taille fixe", c: "Le bouton est tronqué." }] },
                    good: { title: "Corrections", items: [{ f: "Fluide", c: "S'adapte au zoom." }] }
                }
            },
            nl: {
                labTitle: "Toegankelijkheid Empathie Lab", title: "Lage Visus Ervaring",
                name: "Volledige Naam", passport: "Paspoort ID", email: "E-mailadres", btn: "Bijwerken",
                tooltip: "6 cijfers zonder spaties.", passportHint: "(6 cijfers, geen spaties)",
                tabTest: "Testen", tabUser: "Impact", tabIssues: "Problemen", tabRemediations: "Oplossingen",
                testSteps: ["Zoom naar 200%.", "Icoon staat te ver.", "Knop wordt afgesneden."],
                userTitle: "Wie heeft er last van?", userList: ["Slechtzienden", "Vergrootglas gebruikers"],
                critiques: {
                    bad: { title: "Problemen", items: [{ f: "Afgebroken", c: "Vaste breedte op knop." }] },
                    good: { title: "Oplossingen", items: [{ f: "Flexibel", c: "Groeit mee met zoom." }] }
                }
            },
            de: {
                labTitle: "Barrierefreiheit Empathie-Labor", title: "Sehbehinderung Erfahrung",
                name: "Name", passport: "Reisepass-ID", email: "E-Mail", btn: "Aktualisieren",
                tooltip: "6 Stellen ohne Leerzeichen.", passportHint: "(6 Stellen)",
                tabTest: "Testen", tabUser: "Impact", tabIssues: "Probleme", tabRemediations: "Lösungen",
                testSteps: ["Zoom auf 200%.", "Icon zu weit rechts.", "Button abgeschnitten."],
                userTitle: "Wer ist betroffen?", userList: ["Sehbehinderte", "Bildschirmlupen-Nutzer"],
                critiques: {
                    bad: { title: "Probleme", items: [{ f: "Abgeschnitten", c: "Feste Größe." }] },
                    good: { title: "Lösungen", items: [{ f: "Flüssig", c: "Skaliert mit." }] }
                }
            }
        };

        let currentLang = 'en';

        function updateZoomVariable() {
            const isAcc = document.getElementById('modeToggle').checked;
            const zoom = window.devicePixelRatio || 1;
            document.documentElement.style.setProperty('--reverse-zoom', isAcc ? 1 : 1 / zoom);
        }

        function setLanguage(lang) {
            currentLang = lang;
            const t = translations[lang] || translations['en'];
            const isAcc = document.getElementById('modeToggle').checked;
            
            document.getElementById('txt-lab-title').innerText = t.labTitle;
            document.getElementById('txt-title').innerText = t.title;
            document.getElementById('txt-label-name').innerText = t.name;
            document.getElementById('txt-label-email').innerText = t.email;
            document.getElementById('txt-btn').innerText = t.btn;
            document.getElementById('txt-tooltip').innerText = t.tooltip;
            document.getElementById('txt-test-steps').innerHTML = t.testSteps.map(s => `<li>${s}</li>`).join('');
            
            const pInput = document.getElementById('passport-input');
            const pLabel = document.getElementById('txt-label-passport');
            if (isAcc) {
                pLabel.innerText = `${t.passport} ${t.passportHint}`;
                pInput.placeholder = "";
            } else {
                pLabel.innerText = t.passport;
                pInput.placeholder = "e.g. AB1234";
            }

            document.getElementById('txt-user-content').innerHTML = `
                <h3 class="text-blue-400 font-bold uppercase mb-4 text-xs">${t.userTitle}</h3>
                <ul class="list-disc pl-5 space-y-3">${t.userList.map(li => `<li>${li.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>')}</li>`).join('')}</ul>
            `;

            updateMode();
            document.querySelectorAll('.lang-btn').forEach(b => b.className = "lang-btn px-2 py-1 rounded bg-gray-200 text-gray-700");
            document.getElementById('btn-' + lang).className = "lang-btn px-2 py-1 rounded bg-blue-600 text-white";
        }

        function toggleMode() {
            updateZoomVariable();
            setLanguage(currentLang);
        }

        function updateMode() {
            const isAcc = document.getElementById('modeToggle').checked;
            const t = translations[currentLang] || translations['en'];
            const crit = isAcc ? t.critiques.good : t.critiques.bad;
            
            document.getElementById('bodyTag').className = isAcc ? "bg-gray-100 min-h-screen p-4 md:p-8 font-sans accessible-mode" : "bg-gray-100 min-h-screen p-4 md:p-8 font-sans inaccessible-mode";
            
            document.getElementById('tab-feedback').innerText = isAcc ? t.tabRemediations : t.tabIssues;
            document.getElementById('txt-feedback-title').innerText = crit.title;
            document.getElementById('critiqueContent').innerHTML = (crit.items || []).map(i => `<div><span class="text-blue-400 font-bold block mb-1 uppercase text-[11px]">${i.f}</span><p class="text-white opacity-90">${i.c}</p></div>`).join('');
        }

        function switchTab(tabId) {
            ['test', 'feedback', 'user'].forEach(id => {
                const panel = document.getElementById('panel-' + id);
                const tab = document.getElementById('tab-' + id);
                if (panel) panel.classList.toggle('hidden', id !== tabId);
                if (tab) tab.setAttribute('aria-selected', id === tabId);
            });
        }

        const infoBtn = document.getElementById('info-btn');
        const tooltip = document.getElementById('txt-tooltip');
        infoBtn.addEventListener('keydown', (e) => {
            if (document.getElementById('modeToggle').checked && (e.key === ' ' || e.key === 'Enter')) {
                e.preventDefault();
                tooltip.classList.toggle('kb-visible');
            }
        });

        window.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                tooltip.classList.remove('kb-visible');
                tooltip.style.display = 'none';
                setTimeout(() => tooltip.style.display = '', 500);
            }
        });

        window.addEventListener('resize', updateZoomVariable);
        setLanguage('en');
        switchTab('test');
    </script>
</body>
</html>
